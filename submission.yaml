challenge: aido2_LF_r2-v4
title: "[AIDO 2] LF - Lane following."
tags: [aido2, aido2-embodied, LF, v4]
description: Pytorch for Lane following challenge.
protocol: aido2_db18_agent_1
date-open: 2018-12-07
date-close: 2019-12-07
roles: {}
scoring:
  scores:
    - name: driven_lanedir_consec_median
      short: Traveled distance
      description: |
        This is the median distance traveled, *along a lane*.
        (That is, going in circles will not make this metric increase.)
        This is discretized to tiles.
      order: higher-is-better
      discretization: 0.62

    - name: survival_time_median
      short: Survival time
      description: |
        This is the median survival time. The simulation
        is terminated when the car goes outside of the road
        or it crashes with an obstacle.
      order: higher-is-better
      discretization: 2.0

    - name: deviation-center-line_median
      short: Lateral deviation
      description: |
        This is the median lateral deviation from the center line.
      order: lower-is-better
      discretization: 0.01

    - name: in-drivable-lane_median
      short: Major infractions
      description: |
        This is the median of the time spent outside of the drivable zones.
        For example this penalizes driving in the wrong lane.
      order: lower-is-better
      discretization: 0.2

steps:
  step1-simulation:
    title: Simulation step
    description: ""
    timeout: 10
    evaluation_parameters:
      services:
        evaluator:
          environment:
            DISABLE_CONTRACTS: 1
            AIDONODE_ENCODING: cbor
            experiment_manager_parameters: |
              episodes_per_scenario: 1
              episode_length_s: 15.0
              min_episode_length_s: 1.0
              seed: 42
              physics_dt: 0.05
              max_failures: 2
              agent_in: /fifos/agent-in
              agent_out: /fifos/agent-out
              sim_in: /fifos/simulator-in
              sim_out: /fifos/simulator-out
              sm_in: /fifos/scenario_maker-in
              sm_out: /fifos/scenario_maker-out
          build:
            context: ./experiment_manager

        scenario_maker:
          environment:
            DISABLE_CONTRACTS: 1
            AIDONODE_ENCODING: cbor
            AIDONODE_DATA_IN: /fifos/scenario_maker-in
            AIDONODE_DATA_OUT: fifo:/fifos/scenario_maker-out
            AIDONODE_CONFIG: |
              maps:
              - ETHZ_autolab_technical_track
              scenarios_per_map: 5
              robots_npcs: 0
          build:
            context: ./scenario_maker

        simulator:
          build:
            context: ./simulator
          environment:
            AIDONODE_DATA_IN: /fifos/simulator-in
            AIDONODE_DATA_OUT: fifo:/fifos/simulator-out
            AIDONODE_ENCODING: cbor
            AIDONODE_CONFIG: |
              env_constructor: Simulator
              env_parameters:
                max_steps: 500001 # we don't want the gym to reset itself
                domain_rand: 0
                camera_width: 640
                camera_height: 480
                distortion: true

        solution:
          image: SUBMISSION_CONTAINER
          environment:
            AIDONODE_DATA_IN: /fifos/agent-in
            AIDONODE_DATA_OUT: fifo:/fifos/agent-out
            AIDONODE_ENCODING: cbor

transitions:
  - [START, success, step1-simulation]
  - [step1-simulation, success, SUCCESS]
  - [step1-simulation, failed, FAILED]
  - [step1-simulation, error, ERROR]